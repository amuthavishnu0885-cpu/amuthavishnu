<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arulmigu Narayana Swamy Temple - Donation Portal</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter for English, Noto Sans Tamil for Tamil -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+Tamil:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Apply fonts based on language */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-image 0.5s ease-in-out;
        }
        
        [lang="ta"] body, [lang="ta"] button, [lang="ta"] input, [lang="ta"] h1, [lang="ta"] h2, [lang="ta"] h3, [lang="ta"] p, [lang="ta"] label, [lang="ta"] a, [lang="ta"] th, [lang="ta"] td, [lang="ta"] span {
            font-family: 'Noto Sans Tamil', sans-serif;
        }

        /* Background Image Styling */
        .background-container {
            background-image: url('https://placehold.co/1920x1080/FFF8E1/A67B5B?text=Temple+Background');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        /* Header Image Styling */
        .header-image {
            background-image: url('https://placehold.co/1200x300/E67E22/FFFFFF?text=Arulmigu+Narayana+Swamy+Temple');
            background-size: cover;
            background-position: center;
            height: 250px;
        }

        /* Footer Image Styling */
        .footer-image {
            background-image: url('https://placehold.co/1200x150/34495E/FFFFFF?text=Temple+Art+Footer');
            background-size: cover;
            background-position: center;
            height: 100px;
        }
        
        /* Glassmorphism effect for containers - Increased opacity for better readability */
        .glass-card {
            background: rgba(255, 255, 255, 0.65); /* Increased from 0.2 to 0.65 */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Hide scrollbar but allow scrolling */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Print-specific styles */
        @media print {
            body * {
                visibility: hidden;
            }
            #donors-print-area, #donors-print-area * {
                visibility: visible;
            }
            #donors-print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            table {
                width: 100%;
                border-collapse: collapse;
            }
            th, td {
                border: 1px solid #ddd;
                padding: 8px;
            }
            th {
                background-color: #f2f2f2;
            }
        }
    </style>
</head>
<body class="background-container bg-orange-50 text-gray-800">

    <div id="app" class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="header-image shadow-lg relative no-print">
            <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4">
                <h1 id="header-title" class="text-3xl md:text-5xl font-bold text-white text-center tracking-wider" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.7);">
                    Arulmigu Narayana Swamy Temple Donation Portal
                </h1>
            </div>
        </header>

        <!-- Language and Admin Toggle -->
        <nav class="sticky top-0 z-40 bg-white/30 backdrop-blur-md shadow-md no-print">
            <div class="container mx-auto px-4 py-2 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <button onclick="switchLanguage('en')" class="lang-btn en-btn px-4 py-2 bg-orange-500 text-white rounded-md shadow-sm hover:bg-orange-600 transition-colors focus:outline-none focus:ring-2 focus:ring-orange-400">English</button>
                    <button onclick="switchLanguage('ta')" class="lang-btn ta-btn px-4 py-2 bg-gray-500 text-white rounded-md shadow-sm hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400">தமிழ்</button>
                </div>
                <div>
                    <a href="#admin-login" id="admin-login-link" onclick="showAdminLoginPrompt()" class="text-sm font-medium text-orange-700 hover:text-orange-900 transition-colors">
                        Admin Login
                    </a>
                </div>
            </div>
        </nav>

        <main class="flex-grow container mx-auto p-4 md:p-8">
            <!-- User View -->
            <div id="user-view">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Donation Form -->
                    <div class="glass-card p-6 md:p-8">
                        <h2 id="form-title" class="text-2xl font-bold mb-6 text-gray-900">Make a Donation</h2>
                        <form id="donation-form" class="space-y-4">
                            <!-- Form inputs remain the same -->
                            <div>
                                <label for="donorName" class="block text-sm font-medium text-gray-700 data-translate" data-key="donorNameLabel">Donor Name</label>
                                <input type="text" id="donorName" name="donorName" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500">
                            </div>
                            <div>
                                <label for="address" class="block text-sm font-medium text-gray-700 data-translate" data-key="addressLabel">Address</label>
                                <textarea id="address" name="address" rows="3" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500"></textarea>
                            </div>
                            <div>
                                <label for="phone" class="block text-sm font-medium text-gray-700 data-translate" data-key="phoneLabel">Phone Number</label>
                                <input type="tel" id="phone" name="phone" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500">
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 data-translate" data-key="emailLabel">Email ID</label>
                                <input type="email" id="email" name="email" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500">
                            </div>
                             <div>
                                <label for="amount" class="block text-sm font-medium text-gray-700 data-translate" data-key="amountLabel">Donation Amount (₹)</label>
                                <input type="number" id="amount" name="amount" min="1" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500">
                            </div>
                             <div>
                                <label for="transactionId" class="block text-sm font-medium text-gray-700 data-translate" data-key="transactionIdLabel">UPI Transaction ID</label>
                                <input type="text" id="transactionId" name="transactionId" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500" placeholder-key="transactionIdPlaceholder">
                            </div>
                            <button type="submit" id="submit-btn" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:bg-green-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                                Submit Donation
                            </button>
                        </form>
                    </div>

                    <!-- QR Code and Instructions -->
                    <div class="glass-card p-6 md:p-8 flex flex-col items-center justify-center">
                        <h2 id="payment-title" class="text-2xl font-bold mb-4 text-gray-900 text-center">Scan to Pay</h2>
                        <img src="https://placehold.co/300x300/FFFFFF/000000?text=Scan+UPI+QR+Code" alt="UPI QR Code" class="rounded-lg shadow-lg border-4 border-white">
                        <p id="payment-instructions" class="mt-4 text-center text-gray-700">
                            After payment, please enter the UPI Transaction ID in the form and submit your details.
                        </p>
                    </div>
                </div>

                 <!-- User View Tabs for Photos and Events -->
                <div class="glass-card p-6 md:p-8 mt-8">
                     <div class="border-b border-gray-200/50 mb-6">
                        <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                            <button onclick="switchUserTab('user-photos')" id="user-photos-tab-btn" class="user-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-orange-500 text-orange-800" data-key="photosTab">Temple Photos</button>
                            <button onclick="switchUserTab('user-events')" id="user-events-tab-btn" class="user-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-400" data-key="eventsTab">Special Days</button>
                        </nav>
                    </div>
                    <!-- User Tab Content -->
                    <div>
                        <div id="user-photos-content" class="user-tab-content">
                             <div id="user-photo-gallery" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                <p id="user-no-photos-msg" class="col-span-full text-center py-4 data-translate" data-key="noPhotos">No photos uploaded yet.</p>
                            </div>
                        </div>
                        <div id="user-events-content" class="user-tab-content hidden">
                            <div id="user-events-list" class="space-y-4">
                                <p id="user-no-events-msg" class="text-center py-4 data-translate" data-key="noEvents">No events scheduled yet.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin View (Hidden by default) -->
            <div id="admin-view" class="hidden no-print">
                 <div class="glass-card p-6 md:p-8">
                     <div class="flex justify-between items-start mb-6">
                        <h2 id="admin-dashboard-title" class="text-3xl font-bold text-gray-900">Admin Dashboard</h2>
                        <button onclick="logoutAdmin()" id="logout-btn" class="bg-red-500 text-white px-4 py-2 rounded-md shadow hover:bg-red-600 transition">Logout</button>
                     </div>
                    <!-- Admin Tabs -->
                    <div class="border-b border-gray-200">
                        <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                            <button onclick="switchAdminTab('donors')" id="donors-tab-btn" class="admin-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-orange-500 text-orange-600" data-key="donorsTab">Donors</button>
                            <button onclick="switchAdminTab('photos')" id="photos-tab-btn" class="admin-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-key="photosTab">Upload Photos</button>
                            <button onclick="switchAdminTab('events')" id="events-tab-btn" class="admin-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-key="eventsTab">Manage Events</button>
                        </nav>
                    </div>

                    <!-- Tab Content -->
                    <div class="mt-6">
                        <!-- Donors List -->
                        <div id="donors-content" class="admin-tab-content">
                            <div class="flex justify-between items-center mb-4">
                                <h3 id="donors-list-title" class="text-xl font-semibold text-gray-800">Donors List</h3>
                                <div class="space-x-2">
                                     <button onclick="printDonors()" id="print-btn" class="bg-blue-500 text-white px-4 py-2 rounded-md shadow hover:bg-blue-600 transition">Print</button>
                                     <button onclick="exportToCSV()" id="export-btn" class="bg-green-500 text-white px-4 py-2 rounded-md shadow hover:bg-green-600 transition">Export to Excel</button>
                                </div>
                            </div>
                             <div id="donors-print-area" class="overflow-x-auto bg-white rounded-lg shadow">
                                 <table class="min-w-full divide-y divide-gray-200">
                                     <thead class="bg-gray-50">
                                         <tr>
                                             <th id="donor-header-name" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                             <th id="donor-header-details" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact Details</th>
                                             <th id="donor-header-amount" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                             <th id="donor-header-transaction" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Transaction ID</th>
                                         </tr>
                                     </thead>
                                     <tbody id="donors-table-body" class="bg-white divide-y divide-gray-200">
                                         <tr><td colspan="4" class="text-center py-4 data-translate" data-key="noDonations">No donations yet.</td></tr>
                                     </tbody>
                                 </table>
                             </div>
                        </div>

                        <!-- Temple Photos -->
                        <div id="photos-content" class="admin-tab-content hidden">
                            <h3 id="photo-gallery-title" class="text-xl font-semibold mb-4 text-gray-800">Upload Temple Photos</h3>
                            <form id="photo-upload-form" class="mb-6 p-4 bg-gray-50 rounded-lg border flex flex-col md:flex-row items-center gap-4">
                                <div class="flex-grow w-full">
                                    <label for="photoFile" class="sr-only data-translate" data-key="uploadLabel">Upload Photo</label>
                                    <input type="file" id="photoFile" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100"/>
                                </div>
                                <button type="submit" id="upload-btn" class="w-full md:w-auto bg-orange-500 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-orange-600 transition">Upload</button>
                            </form>
                            <p class="text-sm text-gray-600 data-translate" data-key="photoManageInfo">Uploaded photos will be visible to all users on the main page.</p>
                        </div>
                        
                        <!-- Special Days/Events -->
                        <div id="events-content" class="admin-tab-content hidden">
                            <h3 id="special-days-title" class="text-xl font-semibold mb-4 text-gray-800">Manage Special Days & Events</h3>
                            <form id="event-form" class="mb-6 p-4 bg-gray-50 rounded-lg border space-y-3">
                                <h4 id="add-event-title" class="font-medium text-gray-700">Add New Event</h4>
                                <div>
                                    <label for="eventDate" class="sr-only data-translate" data-key="eventDateLabel">Event Date</label>
                                    <input type="date" id="eventDate" required class="w-full p-2 border rounded-md" placeholder-key="eventDateLabel">
                                </div>
                                <div>
                                    <label for="eventDescription" class="sr-only data-translate" data-key="eventDescLabel">Event Description</label>
                                    <textarea id="eventDescription" rows="3" required class="w-full p-2 border rounded-md" placeholder-key="eventDescPlaceholder"></textarea>
                                </div>
                                <button type="submit" id="add-event-btn" class="w-full bg-orange-500 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-orange-600 transition">Add Event</button>
                            </form>
                             <p class="text-sm text-gray-600 data-translate" data-key="eventManageInfo">Added events will be visible to all users on the main page.</p>
                        </div>
                    </div>
                 </div>
            </div>

             <!-- Custom Alert Modal -->
            <div id="alert-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4 no-print">
                <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm text-center">
                    <p id="alert-message" class="text-lg mb-4"></p>
                    <button onclick="closeAlert()" id="alert-ok-btn" class="bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600">OK</button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer-image mt-8 no-print relative">
             <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4">
                 <p class="text-white text-center text-sm">&copy; <span id="footer-text">2025 Arulmigu Narayana Swamy Temple. All Rights Reserved.</span></p>
            </div>
        </footer>
    </div>

    <script>
        // --- DATA STORE ---
        let donations = [];
        let templePhotos = [];
        let specialEvents = [];

        // --- TRANSLATIONS ---
        const translations = {
            en: {
                headerTitle: "Arulmigu Narayana Swamy Temple Donation Portal",
                adminLoginLink: "Admin Login",
                formTitle: "Make a Donation",
                donorNameLabel: "Donor Name",
                addressLabel: "Address",
                phoneLabel: "Phone Number",
                emailLabel: "Email ID",
                amountLabel: "Donation Amount (₹)",
                transactionIdLabel: "UPI Transaction ID",
                transactionIdPlaceholder: "Enter ID from your UPI app",
                submitBtn: "Submit Donation",
                paymentTitle: "Scan to Pay",
                paymentInstructions: "After payment, please enter the UPI Transaction ID in the form and submit your details.",
                adminDashboardTitle: "Admin Dashboard",
                logoutBtn: "Logout",
                donorsTab: "Donors",
                photosTab: "Temple Photos",
                uploadPhotosTab: "Upload Photos",
                eventsTab: "Special Days",
                manageEventsTab: "Manage Events",
                donorsListTitle: "Donors List",
                donorHeaderName: "Name",
                donorHeaderDetails: "Contact Details",
                donorHeaderAmount: "Amount",
                donorHeaderTransaction: "Transaction ID",
                noDonations: "No donations yet.",
                photoGalleryTitle: "Upload Temple Photos",
                photoManageInfo: "Uploaded photos will be visible to all users on the main page.",
                uploadLabel: "Upload Photo",
                uploadBtn: "Upload",
                noPhotos: "No photos uploaded yet.",
                specialDaysTitle: "Manage Special Days & Events",
                eventManageInfo: "Added events will be visible to all users on the main page.",
                addEventTitle: "Add New Event",
                eventDateLabel: "Event Date",
                eventDescLabel: "Event Description",
                eventDescPlaceholder: "E.g., Special Pooja for Vaikunta Ekadasi",
                addEventBtn: "Add Event",
                noEvents: "No events scheduled yet.",
                footerText: `${new Date().getFullYear()} Arulmigu Narayana Swamy Temple. All Rights Reserved.`,
                passwordPrompt: "Enter admin password:",
                wrongPassword: "Wrong password. Access denied.",
                donationSuccess: "Thank you for your generous donation!",
                fillFields: "Please fill all required fields.",
                photoUploadSuccess: "Photo uploaded successfully!",
                eventAddedSuccess: "Event added successfully!",
                alertOkBtn: "OK",
                printBtn: "Print",
                exportBtn: "Export to Excel"
            },
            ta: {
                headerTitle: "அருள்மிகு நாராயண சுவாமி திருக்கோவில் நன்கொடை தளம்",
                adminLoginLink: "நிர்வாகி உள்நுழைவு",
                formTitle: "நன்கொடை அளியுங்கள்",
                donorNameLabel: "நன்கொடையாளர் பெயர்",
                addressLabel: "முகவரி",
                phoneLabel: "தொலைபேசி எண்",
                emailLabel: "மின்னஞ்சல் முகவரி",
                amountLabel: "நன்கொடைத் தொகை (₹)",
                transactionIdLabel: "UPI பரிவர்த்தனை ஐடி",
                transactionIdPlaceholder: "UPI செயலியில் இருந்து ஐடியை உள்ளிடவும்",
                submitBtn: "நன்கொடையை சமர்ப்பிக்கவும்",
                paymentTitle: "பணம் செலுத்த ஸ்கேன் செய்யவும்",
                paymentInstructions: "பணம் செலுத்திய பிறகு, UPI பரிவர்த்தனை ஐடியை படிவத்தில் உள்ளிட்டு உங்கள் விவரங்களைச் சமர்ப்பிக்கவும்.",
                adminDashboardTitle: "நிர்வாகி டாஷ்போர்டு",
                logoutBtn: "வெளியேறு",
                donorsTab: "நன்கொடையாளர்கள்",
                photosTab: "கோவில் புகைப்படங்கள்",
                uploadPhotosTab: "புகைப்படங்களை பதிவேற்றவும்",
                eventsTab: "சிறப்பு நாட்கள்",
                manageEventsTab: "நிகழ்வுகளை நிர்வகிக்கவும்",
                donorsListTitle: "நன்கொடையாளர் பட்டியல்",
                donorHeaderName: "பெயர்",
                donorHeaderDetails: "தொடர்பு விவரங்கள்",
                donorHeaderAmount: "தொகை",
                donorHeaderTransaction: "பரிவர்த்தனை ஐடி",
                noDonations: "இன்னும் நன்கொடைகள் வரவில்லை.",
                photoGalleryTitle: "கோவில் புகைப்படங்களை பதிவேற்றவும்",
                photoManageInfo: "பதிவேற்றிய புகைப்படங்கள் முகப்புப் பக்கத்தில் உள்ள அனைத்து பயனர்களுக்கும் தெரியும்.",
                uploadLabel: "புகைப்படத்தை பதிவேற்றவும்",
                uploadBtn: "பதிவேற்று",
                noPhotos: "புகைப்படங்கள் இன்னும் பதிவேற்றப்படவில்லை.",
                specialDaysTitle: "சிறப்பு நாட்கள் & நிகழ்வுகளை நிர்வகிக்கவும்",
                eventManageInfo: "சேர்க்கப்பட்ட நிகழ்வுகள் முகப்புப் பக்கத்தில் உள்ள அனைத்து பயனர்களுக்கும் தெரியும்.",
                addEventTitle: "புதிய நிகழ்வைச் சேர்க்கவும்",
                eventDateLabel: "நிகழ்வு தேதி",
                eventDescLabel: "நிகழ்வு விளக்கம்",
                eventDescPlaceholder: "எ.கா., வைகுண்ட ஏகாதசி சிறப்பு பூஜை",
                addEventBtn: "நிகழ்வைச் சேர்",
                noEvents: "இன்னும் நிகழ்வுகள் திட்டமிடப்படவில்லை.",
                footerText: `${new Date().getFullYear()} அருள்மிகு நாராயண சுவாமி திருக்கோவில். அனைத்து உரிமைகளும் பாதுகாக்கப்பட்டவை.`,
                passwordPrompt: "நிர்வாகி கடவுச்சொல்லை உள்ளிடவும்:",
                wrongPassword: "தவறான கடவுச்சொல். அணுகல் மறுக்கப்பட்டது.",
                donationSuccess: "உங்கள் தாராளமான நன்கொடைக்கு நன்றி!",
                fillFields: "தேவையான அனைத்து புலங்களையும் நிரப்பவும்.",
                photoUploadSuccess: "புகைப்படம் வெற்றிகரமாக பதிவேற்றப்பட்டது!",
                eventAddedSuccess: "நிகழ்வு வெற்றிகரமாக சேர்க்கப்பட்டது!",
                alertOkBtn: "சரி",
                printBtn: "அச்சிடுக",
                exportBtn: "Excel-க்கு ஏற்றுமதி செய்"
            }
        };

        let currentLanguage = 'en';

        // --- DOM ELEMENTS ---
        const donationForm = document.getElementById('donation-form');
        const photoUploadForm = document.getElementById('photo-upload-form');
        const eventForm = document.getElementById('event-form');
        const alertModal = document.getElementById('alert-modal');
        const alertMessage = document.getElementById('alert-message');

        // --- UTILITY FUNCTIONS ---
        function showAlert(messageKey) {
            alertMessage.textContent = translations[currentLanguage][messageKey];
            alertModal.classList.remove('hidden');
            alertModal.classList.add('flex');
        }

        function closeAlert() {
            alertModal.classList.add('hidden');
            alertModal.classList.remove('flex');
        }

        // --- LANGUAGE SWITCHER ---
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang;
            
            if (lang === 'en') {
                document.querySelector('.en-btn').classList.add('bg-orange-500');
                document.querySelector('.en-btn').classList.remove('bg-gray-500');
                document.querySelector('.ta-btn').classList.add('bg-gray-500');
                document.querySelector('.ta-btn').classList.remove('bg-orange-500');
            } else {
                document.querySelector('.ta-btn').classList.add('bg-orange-500');
                document.querySelector('.ta-btn').classList.remove('bg-gray-500');
                document.querySelector('.en-btn').classList.add('bg-gray-500');
                document.querySelector('.en-btn').classList.remove('bg-orange-500');
            }

            // Translate all elements with data-translate attribute
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            
             // Translate specific elements by ID
            document.getElementById('header-title').textContent = translations[lang].headerTitle;
            document.getElementById('admin-login-link').textContent = translations[lang].adminLoginLink;
            document.getElementById('form-title').textContent = translations[lang].formTitle;
            document.getElementById('submit-btn').textContent = translations[lang].submitBtn;
            document.getElementById('payment-title').textContent = translations[lang].paymentTitle;
            document.getElementById('payment-instructions').textContent = translations[lang].paymentInstructions;
            document.getElementById('footer-text').textContent = translations[lang].footerText;
            document.getElementById('admin-dashboard-title').textContent = translations[lang].adminDashboardTitle;
            document.getElementById('logout-btn').textContent = translations[lang].logoutBtn;
            document.getElementById('donors-tab-btn').textContent = translations[lang].donorsTab;
            document.getElementById('photos-tab-btn').textContent = translations[lang].uploadPhotosTab;
            document.getElementById('events-tab-btn').textContent = translations[lang].manageEventsTab;
            document.getElementById('donors-list-title').textContent = translations[lang].donorsListTitle;
            document.getElementById('donor-header-name').textContent = translations[lang].donorHeaderName;
            document.getElementById('donor-header-details').textContent = translations[lang].donorHeaderDetails;
            document.getElementById('donor-header-amount').textContent = translations[lang].donorHeaderAmount;
            document.getElementById('donor-header-transaction').textContent = translations[lang].donorHeaderTransaction;
            document.getElementById('photo-gallery-title').textContent = translations[lang].photoGalleryTitle;
            document.getElementById('upload-btn').textContent = translations[lang].uploadBtn;
            document.getElementById('special-days-title').textContent = translations[lang].specialDaysTitle;
            document.getElementById('add-event-title').textContent = translations[lang].addEventTitle;
            document.getElementById('add-event-btn').textContent = translations[lang].addEventBtn;
            document.getElementById('alert-ok-btn').textContent = translations[lang].alertOkBtn;
            document.getElementById('print-btn').textContent = translations[lang].printBtn;
            document.getElementById('export-btn').textContent = translations[lang].exportBtn;
            document.getElementById('user-photos-tab-btn').textContent = translations[lang].photosTab;
            document.getElementById('user-events-tab-btn').textContent = translations[lang].eventsTab;


            // Translate placeholders
            document.querySelectorAll('[placeholder-key]').forEach(el => {
                const key = el.getAttribute('placeholder-key');
                if(translations[lang][key]){
                    el.placeholder = translations[lang][key];
                }
            });

            // Re-render content to apply language changes
            renderAll();
        }

        // --- ADMIN AUTH ---
        function showAdminLoginPrompt() {
            const password = prompt(translations[currentLanguage].passwordPrompt);
            if (password === 'password123') {
                document.getElementById('user-view').classList.add('hidden');
                document.getElementById('admin-view').classList.remove('hidden');
            } else if (password !== null) {
                showAlert('wrongPassword');
            }
        }
        
        function logoutAdmin() {
            document.getElementById('admin-view').classList.add('hidden');
            document.getElementById('user-view').classList.remove('hidden');
        }

        // --- TAB SWITCHERS ---
        function switchAdminTab(tabName) {
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('border-orange-500', 'text-orange-600');
                tab.classList.add('border-transparent', 'text-gray-500');
            });
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
            document.getElementById(`${tabName}-tab-btn`).classList.add('border-orange-500', 'text-orange-600');
        }

        function switchUserTab(tabName) {
             document.querySelectorAll('.user-tab-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('.user-tab').forEach(tab => {
                tab.classList.remove('border-orange-500', 'text-orange-800');
                tab.classList.add('border-transparent', 'text-gray-600');
            });
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
            document.getElementById(`${tabName}-tab-btn`).classList.add('border-orange-500', 'text-orange-800');
        }


        // --- RENDER FUNCTIONS ---
        function renderAll() {
            renderDonors();
            renderPhotos();
            renderEvents();
        }

        function renderDonors() {
            const tbody = document.getElementById('donors-table-body');
            tbody.innerHTML = '';
            if (donations.length === 0) {
                 tbody.innerHTML = `<tr><td colspan="4" class="text-center py-4">${translations[currentLanguage].noDonations}</td></tr>`;
                 return;
            }
            donations.forEach(d => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${d.donorName}</div>
                        <div class="text-sm text-gray-500">${d.address}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                         <div class="text-sm text-gray-900">${d.phone}</div>
                        <div class="text-sm text-gray-500">${d.email}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">₹${d.amount}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${d.transactionId}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function renderPhotos() {
            const userGallery = document.getElementById('user-photo-gallery');
            userGallery.innerHTML = '';
            
            if (templePhotos.length === 0) {
                userGallery.innerHTML = `<p class="col-span-full text-center py-4">${translations[currentLanguage].noPhotos}</p>`;
            } else {
                 templePhotos.forEach(photoSrc => {
                    const imgContainer = document.createElement('div');
                    imgContainer.className = "relative group";
                    imgContainer.innerHTML = `<img src="${photoSrc}" alt="Temple Photo" class="w-full h-48 object-cover rounded-lg shadow-md transition-transform transform group-hover:scale-105">`;
                    userGallery.appendChild(imgContainer);
                });
            }
        }

        function renderEvents() {
            const userList = document.getElementById('user-events-list');
            userList.innerHTML = '';
            
            if (specialEvents.length === 0) {
                userList.innerHTML = `<p class="text-center py-4">${translations[currentLanguage].noEvents}</p>`;
            } else {
                const sortedEvents = [...specialEvents].sort((a, b) => new Date(a.date) - new Date(b.date));
                sortedEvents.forEach(event => {
                    const eventCard = document.createElement('div');
                    eventCard.className = "bg-white/50 p-4 rounded-lg shadow border-l-4 border-orange-400";
                    const eventDate = new Date(event.date);
                    const formattedDate = eventDate.toLocaleDateString(currentLanguage === 'ta' ? 'ta-IN' : 'en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                    eventCard.innerHTML = `
                        <p class="font-bold text-orange-700">${formattedDate}</p>
                        <p class="text-gray-600 mt-1">${event.description}</p>
                    `;
                    userList.appendChild(eventCard);
                });
            }
        }
        
        // --- ADMIN ACTIONS ---
        function printDonors() {
            window.print();
        }

        function exportToCSV() {
            let csvContent = "data:text/csv;charset=utf-8,";
            const headers = ["Donor Name", "Address", "Phone", "Email", "Amount", "Transaction ID"];
            csvContent += headers.join(",") + "\r\n";

            donations.forEach(d => {
                const row = [d.donorName, `"${d.address.replace(/"/g, '""')}"`, d.phone, d.email, d.amount, d.transactionId];
                csvContent += row.join(",") + "\r\n";
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "donations.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }


        // --- EVENT HANDLERS ---
        donationForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(donationForm);
            const donationData = Object.fromEntries(formData.entries());
            
            if (Object.values(donationData).some(val => !val)) {
                showAlert('fillFields');
                return;
            }
            donations.push(donationData);
            showAlert('donationSuccess');
            donationForm.reset();
            renderDonors();
        });

        photoUploadForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const photoFile = document.getElementById('photoFile').files[0];
            if (photoFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    templePhotos.push(event.target.result);
                    renderPhotos();
                    showAlert('photoUploadSuccess');
                }
                reader.readAsDataURL(photoFile);
                photoUploadForm.reset();
            }
        });

        eventForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const eventDate = document.getElementById('eventDate').value;
            const eventDescription = document.getElementById('eventDescription').value;
            if (eventDate && eventDescription) {
                specialEvents.push({ date: eventDate, description: eventDescription });
                renderEvents();
                showAlert('eventAddedSuccess');
                eventForm.reset();
            } else {
                 showAlert('fillFields');
            }
        });

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            switchLanguage('en'); // Set default language
        });
    </script>
</body>
</html>

